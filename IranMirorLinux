BEST_MIRROR=$(for mirror in mirror.iranserver.com ir.ubuntu.sindad.cloud mirror.arvancloud.ir archive.ubuntu.petiak.ir ubuntu.hostiran.ir mirrors.pardisco.co ubuntu.pars.host mirror.0-1.cloud ubuntu.shatel.ir mirror.faraso.org repo.linuxmirrors.ir; do echo "$(ping -c 3 -W 2 $mirror | tail -1 | awk -F'/' '{print $5}') $mirror"; done | grep '^[0-9]' | sort -n | head -n 1 | awk '{print $2}') && echo "âœ…Best: $BEST_MIRROR" && sudo sed -i.bak "s|http://[a-zA-Z0-9.-]*archive.ubuntu.com/ubuntu|https://$BEST_MIRROR/ubuntu|g" /etc/apt/sources.list /etc/apt/sources.list.d/ubuntu.sources 2>/dev/null && sudo apt update
